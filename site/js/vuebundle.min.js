"use strict";if(document.getElementById("account-app"))var usacAPI2=axios.create({baseURL:"/API",timeout:15e4,withCredentials:!1}),_data={currentResultName:"",currentResultCity:"",currentResultState:"",currentResultDate:"",licenses:[],licenseFilterSelected:"all",licensesOrig:[],licensesComp:[],licenseMaster:{race:[],coach:[],mechanic:[],official:[],uci:[]},race_results:[],results:[],resultsError:!1,rr:{rank_org:"",rank_disc:"",rank_discSelected:"",gender:"",category:"",state:"",age_min:"",age_max:"",page_start:0,page_limit:500},rankings:[],showRaceResults:!1,showResultsRanking:!0,tabOneLoad:!0,uInfoLoad:!0,uProfileLoaded:!1,user_account:[],filterMessage:!1,showApp:!1},acct=new Vue({el:"#account-app",data:function(){return _data},beforeCreate:function(){},mounted:function(){axios.get("/API/waiver/?xfg=293381").then(function(e){""==e.data||"Invalid username/password."==e.data.detail?$(".account-body").show():location.href="/waivers"}).catch(function(e){}),usacAPI2.get("/profile/").then(function(e){_data.user_account=e.data,_data.user_account.user_id||(location.href="/API/logout"),_data.uInfoLoad=!1,_data.uProfileLoaded=!0,usacAPI2.get("/ranking/?comp_id="+_data.user_account.comp_id).then(function(e){e.data[0]&&(_data.rankings=e.data[0]),usacAPI2.get("/licenses/").then(function(e){e.data.forEach(function(e,t){var a=Date.parse(e.date_exp);if(0==isNaN(a)){var n=new Date(e.date_exp);moment().diff(n.toISOString(),"years")<4&&Date.now()<=new Date(e.date_exp)&&""==e.license_status&&_data.licenses.push(e)}}),e.data.forEach(function(e,t){var a=Date.parse(e.date_exp);if(0==isNaN(a)){var n=new Date(e.date_exp);moment().diff(n.toISOString(),"years")<4&&"P"==e.license_status&&_data.licenses.push(e)}}),e.data.forEach(function(e,t){var a=Date.parse(e.date_exp);if(0==isNaN(a)){var n=new Date(e.date_exp);moment().diff(n.toISOString(),"years")<4&&"S"==e.license_status&&_data.licenses.push(e)}}),e.data.forEach(function(e,t){var a=Date.parse(e.date_exp);if(0==isNaN(a)){var n=new Date(e.date_exp);moment().diff(n.toISOString(),"years")<4&&Date.now()>new Date(e.date_exp)&&""==e.license_status&&_data.licenses.push(e)}}),_data.licensesOrig=_data.licenses,usacAPI2.get("/licensescomp/?comp_id="+_data.user_account.comp_id).then(function(e){e.data.forEach(function(e,t){if("TECHNICAL"==e.section_header&&"OFFICIAL"==e.section_subtitle)for(var a in Vue.set(e,"MOTOREF","NO"),Vue.set(e,"STARTER","NO"),Vue.set(e,"SECRETARY","NO"),e.categories)e.categories[a].MOTOREF&&Vue.set(e,"MOTOREF",e.categories[a].MOTOREF),e.categories[a].STARTER&&Vue.set(e,"STARTER",e.categories[a].MOTOREF),e.categories[a].SECRETARY&&Vue.set(e,"SECRETARY",e.categories[a].MOTOREF)}),_data.licensesComp=e.data}).catch(function(e){}),usacAPI2.get("/user-results/").then(function(e){e.data.length>0?(_data.resultsError=!1,_data.results=e.data,$(".standings-table")&&$(".standings-table").footable({calculateWidthOverride:function(){return{width:$(window).width()}}})):_data.resultsError=!0,_data.tabOneLoad=!1}).catch(function(e){})}).catch(function(e){})}).catch(function(e){})}).catch(function(e){})},delimiters:["[[","]]"],filters:{},watch:{"rr.rank_discSelected":function(e,t){var a=e.split(":");_data.rr.rank_org=a[0],_data.rr.rank_disc=a[1]},licenseFilterSelected:function(e,t){switch(_data.filterMessage=!1,e){case"all":_data.licenses=_data.licensesOrig;break;case"active":_data.licenses=[],_data.licensesOrig.filter(function(e){var t=new Date(e.date_exp);Date.now()<t&&""==e.license_status&&_data.licenses.push(e)});break;case"expired":_data.licenses=[],_data.licensesOrig.filter(function(e){var t=new Date(e.date_exp);Date.now()>t&&""==e.license_status&&_data.licenses.push(e)});break;case"pending":_data.licenses=[],_data.licensesOrig.filter(function(e){"P"==e.license_status&&_data.licenses.push(e)});break;case"suspended":_data.licenses=[],_data.licensesOrig.filter(function(e){"S"==e.license_status&&_data.licenses.push(e)})}0==_data.licenses.length&&(_data.filterMessage=!0)}},methods:{convertYN:function(e){return"Y"==e?"YES":"N"==e?"NO":e},rankPerc:function(e,t){return"("+(e/t*100).toFixed(2)+"%)"},pendReason:function(e){return e},friendlyDate:function(e){if(!e)return"";e=e.toString();return new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},returnToResults:function(){_data.showRaceResults=!1,_data.showResultsRanking=!0},catFullName:function(e){if(!e)return"";switch(e=e.toString()){case"rd":return"Road";case"tr":return"Track";case"ot":return"Observed Trials";case"mx":return"Mountain Cross";case"mt":return"Mountain";case"ncca":return"NCCA";case"xc":return"Cross Country";case"cx":return"Cyclocross";case"dh":return"Downhill"}},showResults:function(e){_data.race_results=[],usacAPI2.get("/race-results/?results_race_id="+e).then(function(e){e.data.length>0&&(_data.race_results=e.data,_data.currentResultName=e.data[0].event_name,_data.currentResultCity=e.data[0].race_city,_data.currentResultState=e.data[0].race_state,_data.currentResultDate=e.data[0].race_date,_data.showRaceResults=!0,_data.showResultsRanking=!1),_data.resultsError||$(".race-results-table")&&$(".race-results-table").footable({calculateWidthOverride:function(){return{width:$(window).width()}}})}).catch(function(e){})}}});function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}if(document.getElementById("rr-app")){var _discLookup;Vue.mixin({computed:{unique:function(){return function(e,t){for(var a=[],n={},s=0;s<e.length;s++)n[e[s][t]]||(n[e[s][t]]=!0,a.push(e[s]));return a}}}});var usacRRapi=axios.create({baseURL:"/API",timeout:1e5,withCredentials:!1}),config=(_data={eventNameOrID:"",eventNameOrIDError:!1,nameOrLicense:"",nameOrLicenseError:!1,currentEventName:"",discResults:[],discSelected:"",eidName:"",rr:{rank_org:"Road",rank_disc:"RR",gender:"M",category:"",state:"",age_min:"1",age_max:"99",page_start:0,page_limit:500},discLookup:(_discLookup={XC:"Cross Country",XCM:"Cross Country Marathon",CM:"Cross Country Marathon",DH:"Downhill",ELIM:"Eliminator",MX:"Mountain Cross",STXC:"Short Track Cross Country",DS:"Dual Slalom",TT:"Time Trial",FTT:"Flying Time Trial",SD:"Super D",ED:"Enduro",ITT:"Individual Time Trial",XCU:"Cross Country Ultra Endurance",FB:"Fat Bike",OT:"Observed Trials",AM:"All-Mountain",CRIT:"Criterium",CX:"Cyclo-cross",CCR:"Circuit Race",HR:"Handicap Race",IP:"Individual Pursuit",KEIR:"Keirin",MAD:"Madison",MO:"Miss and Out",OMNI:"Omnium",IO:"International Omnium",PR:"Points Race",RR:"Road Race",HC:"Hill Climb",SR:"Scratch Race",SPR:"Sprints",STR:"Stage Race",GC:"Stage Race",TS:"Tandem Sprint",TSPR:"Team Sprint",TP:"Team Pursuit"},_defineProperty(_discLookup,"FTT","Flying Time Trial"),_defineProperty(_discLookup,"TTT","Team Time Trial"),_defineProperty(_discLookup,"TRK","Track"),_defineProperty(_discLookup,"CCRR","Conference Champ Road Race"),_defineProperty(_discLookup,"CCCRIT","Conference Champ Criterium"),_defineProperty(_discLookup,"CCTTT","Conference Champ Team Time Trial"),_defineProperty(_discLookup,"DS/MX","Dual / Mountain Cross"),_defineProperty(_discLookup,"TR","Team Relay"),_defineProperty(_discLookup,"4KM PURSUIT","4K"),_defineProperty(_discLookup,"TEAM PURSUIT","Team Pursuit"),_defineProperty(_discLookup,"SPRINT","Sprint"),_defineProperty(_discLookup,"POINTS","Points"),_defineProperty(_discLookup,"500 M TT","500M"),_defineProperty(_discLookup,"3KM PURSUIT","3K"),_defineProperty(_discLookup,"1KM TT","1K"),_defineProperty(_discLookup,"POINTS RACE","Points"),_defineProperty(_discLookup,"MIXED TEAM SPRINT","Coed Team"),_defineProperty(_discLookup,"3 KM TEAM PURSUIT","Team Pursuit"),_discLookup),individualResults:[],individualResults2:[],individualResultName:"",showIndividualResults:!1,showIndividualResults2:!1,showLoader:!1,showResultsRankings:!1,showResultsSearch:!0,showRankingsSearch:!0,showReturnToResults:!1,rank_discSelected:"Road:RR",discShow:!1,discEShow:!1,raceResults:[],raceResultsShow:!1,results:[],toggleResults:!0,toggleRankings:!0,leftResults:[],leftResultsShow:!1,working:!1,error_msg:""},""),query="?",rr=new Vue({el:"#rr-app",data:function(){return _data},beforeMount:function(){usacRRapi.get("/profile/").then(function(e){_data.user_account=e.data}).catch(function(e){})},mounted:function(){},delimiters:["[[","]]"],filters:{},watch:{rank_discSelected:function(e,t){var a=e.split(":");_data.rr.rank_org=a[0],_data.rr.rank_disc=a[1]},eventNameOrID:function(e){_data.eventNameOrID.length>0&&(_data.eventNameOrIDError=!1)},nameOrLicense:function(e){_data.nameOrLicense.length>0&&(_data.nameOrLicenseError=!1)},working:function(e){_data.showLoader=!!e}},methods:{showForms:function(){rr.clearDataAndResults(),_data.showResultsSearch=!0,_data.showRankingsSearch=!0,_data.raceResultsShow=!1},hideForms:function(){_data.showResultsSearch=!1,_data.showRankingsSearch=!1},clearDataAndResults:function(){_data.raceResults=[],_data.individualResults=[],_data.individualResults2=[],_data.leftResults=[],_data.discResults=[],_data.leftResultsShow=!1,_data.raceResultsShow=!1,_data.showResultsRankings=!1,_data.showIndividualResults2=!1,_data.showIndividualResults=!1,_data.showReturnToResults=!1,_data.discShow=!1,_data.error_msg=""},returnToEventResults:function(){_data.raceResultsShow=!1,_data.leftResultsShow=!0,rr.footablez()},showEventRaces:function(e,t){document.getElementById("irr").scrollIntoView(),_data.showReturnToResults=!0,_data.raceResults=[],axios.get("./API/race-results/?results_race_id="+e).then(function(e){rr.hideForms(),_data.currentEventName=t,_data.raceResults=e.data,_data.raceResultsShow=!0,_data.leftResultsShow=!1,rr.footablez()}).catch(function(e){})},showDisciplineRaces:function(e){_data.working=!0,axios.get("./API/races/?event_id="+e).then(function(e){_data.leftResultsShow=!1,_data.discResults=e.data,_data.discShow=!0,_data.working=!1}),this.scrollIt()},scrollIt:function(){$("html,body").animate({scrollTop:$(".results-top").offset().top},"slow")},searchEventNameOrLicense:function(){if(""==_data.nameOrLicense)return _data.nameOrLicenseError=!0,!1;this.showReturnToResults=!0,this.clearDataAndResults(),this.hideForms(),this.showReturnToResults=!0,parseInt(_data.nameOrLicense)?axios.get("./API/user-results-search/?comp_id="+_data.nameOrLicense).then(function(e){_data.individualResults2=e.data,rr.footablez(),_data.showIndividualResults2=!0}):this.requestRaceData("?rider_name="+_data.nameOrLicense)},searchEventNameOrID:function(){if(_data.working=!0,_data.eventNameOrID=_data.eventNameOrID.trim(),""==_data.eventNameOrID)return _data.working=!1,_data.eventNameOrIDError=!0,!1;_data.showReturnToResults=!0,this.clearDataAndResults(),this.hideForms(),parseInt(_data.eventNameOrID)?this.requestRaceData("?event_id="+_data.eventNameOrID):this.requestEventData("?source=RR&name="+_data.eventNameOrID)},requestEventData:function(e){_data.showReturnToResults=!0,axios.get("./API/events/"+e).then(function(e){_data.leftResults=e.data;var t=_data.leftResults;t.sort(function(e,t){return Date.parse(e.date_start)<Date.parse(t.date_start)?1:Date.parse(e.date_start)>Date.parse(t.date_start)?-1:0}),_data.leftResults=t,_data.leftResultsShow=!0,_data.working=!1}).catch(function(e){})},requestRaceData:function(e){return _data.showReturnToResults=!0,axios.get("./API/races/"+e).then(function(e){_data.leftResults=e.data,_data.leftResultsShow=!0,_data.working=!1}).catch(function(e){}),!0},backToEvents:function(){_data.discShow=!1,_data.leftResultsShow=!0},hideIndividualResults:function(){_data.showIndividualResults=!1,_data.showIndividualResults2=!1,_data.raceResultsShow=!1,_data.showResultsRankings=!0,_data.individualResults=[],_data.individualResultName="",rr.footablez()},hideIndividualResults2:function(){_data.showIndividualResults2=!1,_data.individualResults2=[],this.showForms(),rr.footablez()},footablez:function(){},loadResults:function(e,t){_data.working=!0,_data.showIndividualResults=!0,_data.showResultsRankings=!1,_data.individualResultName=t,_data.raceResultsShow=!1,_data.leftResultsShow=!1,_data.showReturnToResults=!0,axios.get("./API/user-results-search/?comp_id="+e).then(function(e){_data.individualResults=e.data,_data.working=!1,$("html,body").animate({scrollTop:$(".results-top").offset().top-100},"slow")}).catch(function(e){_data.working=!1}),this.scrollIt()},genderConvert:function(e){switch(e){case"F":return"Women";case"M":return"Men";default:return"All"}},loadMoreResults:function(){_data.rr.page_start+=500;var e=$.param(_data.rr);axios.get("./API/ranking-search/?"+e).then(function(e){e.data.length>0&&e.data.forEach(function(e,t){_data.results.push(e)}),_data.working=!1}).catch(function(e){_data.working=!1})},search:function(){_data.working=!0,_data.rr.page_start=0;var e=$.param(_data.rr);_data.error_msg="",_data.results=[],_data.raceResultsShow=!1,_data.leftResultsShow=!1,_data.showResultsRankings=!1,rr.clearDataAndResults(),rr.hideForms(),_data.showResultsRankings=!0,axios.get("./API/ranking-search/?"+e).then(function(e){e.data.length>0?(_data.results=e.data,_data.showReturnToResults=!0):(_data.showReturnToResults=!1,_data.showResultsRankings=!1,rr.showForms(),_data.error_msg="Your search returned 0 results.  Please check your input and try again."),_data.working=!1}).catch(function(e){_data.working=!1})},showDiscExpand:function(e){_data.discSelected=e},discFullName:function(e){return e?(e=e.toString().toUpperCase(),null!=_data.discLookup[e]&&null!=_data.discLookup[e]?_data.discLookup[e]:"NA"):""}}})}if(document.getElementById("waiver-app"))var usacWVapi=axios.create({baseURL:"/API",timeout:1e5,withCredentials:!1}),wv=(_data={waiverContent:[],waiverID:"",user_account:[],user_age:0},new Vue({el:"#waiver-app",data:function(){return _data},beforeMount:function(){},mounted:function(){axios.get("/API/waiver/?xfg=293381").then(function(e){0==e.length&&(location.href="/account"),_data.waiverContent=e.data[0],_data.waiverID=e.data[0].id,axios.get("/API/profile/").then(function(e){_data.user_account=e.data,_data.user_age=wv.calculateAge(e.data.dob),_data.user_age<19&&($("#waiver-data-form").hide(),$("#waiver-underage").show()),$("#waiver-data-form").foundation()}).catch(function(e){})}).catch(function(e){})},updated:function(){},delimiters:["[[","]]"],filters:{},watch:{},methods:{formatHTML:function(e){return null!=e&&null!=e&&(e=e.replace(new RegExp("\r?\n","g"),"<br />")),e},calculateAge:function(e){return moment().diff(e,"years")}}}));if(document.getElementById("clubs-app"))var baseUrl="/API/clubs/",clubApp=new Vue({el:"#clubs-app",data:{clubs:[],filter:{org:"",state:"",zipcode:"",radius:"5",club:"",womenonly:"",juniorsonly:"",mastersonly:"",page:0,limit:999},pageNumber:0,resultsPerPage:8,loader:!1},delimiters:["[[","]]"],created:function(){this.initGoogleMapsLibs()},computed:{pageCount:function(){var e=this.clubs.length,t=this.resultsPerPage;return Math.ceil(e/t)},paginatedData:function(){var e=this.clubs.length,t=this.pageNumber*this.resultsPerPage,a=t+this.resultsPerPage<e?t+this.resultsPerPage:e;return this.clubs.slice(t,a)}},methods:{nextPage:function(){this.pageNumber++},goToPage:function(e){this.pageNumber=e},prevPage:function(){this.pageNumber--},updateGoogleMap:function(){new google.maps.Map(document.getElementById("google-map"),{zoom:3,center:new google.maps.LatLng(39.0997,-94.5786),mapTypeId:google.maps.MapTypeId.ROADMAP})},initGoogleMapsLibs:function(){var e=document.createElement("script"),t={key:"AIzaSyDy0wL4H7-4TOQGB0yukQnw3n4ECTs2kFU"},a="https://maps.googleapis.com/maps/api/js?"+Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");e.setAttribute("src",a),e.setAttribute("async",""),e.setAttribute("defer",""),document.head.appendChild(e)},buildFilter:function(){var e=[];return $.each(this.filter,function(t,a){0!=a&&""!=a&&e.push(t+"="+a)}),e.length>0?"?"+e.join("&"):""},getClubs:function(e){var t=[];axios.get(e).then(function(e){$.each(e.data,function(e,a){t.push(a)})}).catch(function(e){console.log(e)}).then(function(){clubApp._data.loader=!1}),this.clubs=t},setOrgType:function(e){this.filter.org=e.target.value},setState:function(e){this.filter.state=e.target.value},setZip:function(e){this.filter.zipcode=e.target.value},setRadius:function(e){""!=this.filter.zipcode&&(this.filter.radius=e.target.value)},setClubName:function(e){this.filter.club=e.target.value},setGenderPreference:function(e){"Women"==e.target.value?(this.filter.womenonly="Y",this.filter.juniorsonly="",this.filter.mastersonly=""):"Junior"==e.target.value?(this.filter.womenonly="",this.filter.juniorsonly="Y",this.filter.mastersonly=""):"Master"==e.target.value?(this.filter.womenonly="",this.filter.juniorsonly="",this.filter.mastersonly="Y"):(this.filter.womenonly="",this.filter.juniorsonly="",this.filter.mastersonly="")},submitSearch:function(){this.loader=!0,this.pageNumber=0,this.getClubs(window.location.protocol+"//"+window.location.hostname+baseUrl+this.buildFilter())}}});if(document.getElementById("coaches-app")){baseUrl="/API/coaches/";var coachApp=new Vue({el:"#coaches-app",data:{coaches:[],filter:{Disciplines:"",state:"",zipcode:"",radius:"5",lastname:"",gender:"",cpbt:"",csi:"",L01:"",L02:"",L03:"",BMX01:"",BMX02:"",BMX03:"",page:0,limit:999},modalCoachData:{name:null,certlevel:null,phone:null,website:null,email:null},modalActive:!1,pageNumber:0,resultsPerPage:8,loader:!1},delimiters:["[[","]]"],created:function(){this.initGoogleMapsLibs()},computed:{pageCount:function(){var e=this.coaches.length,t=this.resultsPerPage;return Math.ceil(e/t)},paginatedData:function(){var e=this.coaches.length,t=this.pageNumber*this.resultsPerPage,a=t+this.resultsPerPage<e?t+this.resultsPerPage:e;return this.coaches.slice(t,a)}},methods:{nextPage:function(){this.pageNumber++},goToPage:function(e){this.pageNumber=e},prevPage:function(){this.pageNumber--},updateGoogleMap:function(){new google.maps.Map(document.getElementById("google-map"),{zoom:3,center:new google.maps.LatLng(39.0997,-94.5786),mapTypeId:google.maps.MapTypeId.ROADMAP})},initGoogleMapsLibs:function(){var e=document.createElement("script"),t={key:"AIzaSyDy0wL4H7-4TOQGB0yukQnw3n4ECTs2kFU"},a="https://maps.googleapis.com/maps/api/js?"+Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");e.setAttribute("src",a),e.setAttribute("async",""),e.setAttribute("defer",""),document.head.appendChild(e)},buildFilter:function(){var e=[];return $.each(this.filter,function(t,a){0!=a&&""!=a&&e.push(t+"="+a)}),e.length>0?"?"+e.join("&"):""},getCoaches:function(e){var t=[];axios.get(e).then(function(e){$.each(e.data,function(e,a){t.push(a)})}).catch(function(e){console.log(e)}).then(function(){coachApp._data.loader=!1}),this.coaches=t},setOrgType:function(e){this.filter.Disciplines=e.target.value},setState:function(e){this.filter.state=e.target.value},setZip:function(e){this.filter.zipcode=e.target.value},setRadius:function(e){""!=this.filter.zipcode&&(this.filter.radius=e.target.value)},setLastName:function(e){this.filter.lastname=e.target.value},setGenderPreference:function(e){var t=[];$("input[name=gender]:checked").each(function(e,a){t.push($(a).val())}),t.indexOf("M")>-1&&t.indexOf("F")>-1?this.filter.gender="":1==t.length?this.filter.gender=t[0]:this.filter.gender=""},setCPBT:function(e){this.filter.cpbt=$(e.target).is(":checked")?e.target.value:""},setCSI:function(e){this.filter.csi=$(e.target).is(":checked")?e.target.value:""},setL01:function(e){this.filter.L01=$(e.target).is(":checked")?e.target.value:""},setL02:function(e){this.filter.L02=$(e.target).is(":checked")?e.target.value:""},setL03:function(e){this.filter.L03=$(e.target).is(":checked")?e.target.value:""},setBMX01:function(e){this.filter.BMX01=$(e.target).is(":checked")?e.target.value:""},setBMX02:function(e){this.filter.BMX02=$(e.target).is(":checked")?e.target.value:""},setBMX03:function(e){this.filter.BMX03=$(e.target).is(":checked")?e.target.value:""},submitSearch:function(){this.loader=!0,this.pageNumber=0,this.getCoaches(window.location.protocol+"//"+window.location.hostname+baseUrl+this.buildFilter())},formatPhoneNumber:function(e){var t=(""+e).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return t?"("+t[1]+") "+t[2]+"-"+t[3]:null},launchModal:function(e){this.modalActive=!this.modalActive,this.modalCoachData={name:e.target.getAttribute("data-name"),certlevel:e.target.getAttribute("data-cert-level"),phone:this.formatPhoneNumber(e.target.getAttribute("data-phone")),email:e.target.getAttribute("data-email"),website:e.target.getAttribute("data-website")}},closeModal:function(){this.modalActive=!this.modalActive}}})}if(document.getElementById("profile-app"))var usacProapi=axios.create({baseURL:"/API",timeout:1e5,withCredentials:!1}),renewLinksApi=axios.create({baseURL:"/craft-api/",timeout:1e5,withCredentials:!1}),ACCTprofile=(_data={linksRenew:[],raceRenew:"",rideRenew:"",coachRenew:"",officialRenew:"",mechanicRenew:"",directorRenew:"",driverRenew:"",userProfile:[],hashValue:"",licenses:[],results:[],race_results:[],rankings:[],licensesComp:[],activeLicenseCount:0,expiredLicenseCount:0,racerDynText:"",licenseTabSelect:"active",pendSelect:"",currentResultName:"",currentResultCity:"",currentResultState:"",currentResultDate:"",currentHTMLText:"",showRaceResults:!1,showResultsRanking:!0,showLoader:!0,currentState:"profile",activeClass:"active",activeTabClass:"is-active",errorClass:"",revealAdmin:!1,navList:[{displayName:"Profile",stateName:"profile",licenseType:""},{displayName:"Membership & Benefits",stateName:"membership",licenseType:""},{displayName:"Licenses",stateName:"licenses",licenseType:""},{displayName:"Events",stateName:"events",licenseType:""},{displayName:"Racer Links",stateName:"racer",licenseType:"RX"},{displayName:"Event Director Links",stateName:"event-director",licenseType:"D"},{displayName:"Club Admin",stateName:"club-admin",licenseType:"CLUBADMIN"},{displayName:"Official Links",stateName:"official",licenseType:"O"},{displayName:"Coach Links",stateName:"coach",licenseType:"C"},{displayName:"Pre-Coach",stateName:"pre-coach",licenseType:"PRECOACH"},{displayName:"Technical Support Links",stateName:"technical-support",licenseType:"MV"},{displayName:"Admin",stateName:"admin",licenseType:"ADMIN"}],origNav:[],sortedNav:[]},new Vue({el:"#profile-app",data:function(){return _data},beforeMount:function(){},computed:{orderedNav:function(){var e=this.navList.slice();return e.sort(function(e,t){var a=e.displayName.toUpperCase(),n=t.displayName.toUpperCase();return a<n?-1:a>n?1:0}),e}},mounted:function(){switch(this.loadProfile(),_data.hashValue=window.location.hash.toLowerCase(),_data.origNav=_data.navList,_data.hashValue.length>0&&(_data.currentState=_data.hashValue.replace("#","")),_data.currentState){case"profile":_data.showLoader=!1;break;case"membership":this.loadMembership();break;case"licenses":break;case"racer":this.getContentBySlug("account-racer");break;case"club-admin":this.loadClubAdmin();break;case"official":this.loadOfficial();break;case"pre-coach":this.loadPreCoach();break;case"coach":this.loadCoach();break;case"technical-support":this.loadTechnicalSupport()}},updated:function(){$(".license-details").each(function(e,t){var a=$(t).data("id");$("#print-license-details-"+a).val($(t).html())}),$(".pend-details").each(function(e,t){var a=$(t).data("id");$("#print-pend-details-"+a).val($(t).html())})},delimiters:["[[","]]"],filters:{},watch:{currentState:function(e,t){switch(_data.racerDynText="",this.scrollToTop(),e){case"profile":_data.showLoader=!1;break;case"membership":this.loadMembership();break;case"event-director":this.loadEventDirector();break;case"club-admin":this.loadClubAdmin();break;case"racer":this.getContentBySlug("account-racer");break;case"official":this.loadOfficial();break;case"pre-coach":this.loadPreCoach();break;case"coach":this.loadCoach();break;case"technical-support":this.loadTechnicalSupport();break;case"admin":location.href=$("#adUrl").val()}}},methods:{rebindVals:function(){$(".license-details").each(function(e,t){var a=$(t).data("id");$("#print-license-details-"+a).val($(t).html())}),$(".pend-details").each(function(e,t){var a=$(t).data("id");$("#print-pend-details-"+a).val($(t).html())})},loadLicenses:function(){_data.showLoader=!0,void 0!==_data.licenses&&0!=_data.licenses.length||usacProapi.get("/licenses/").then(function(e){e.data.forEach(function(e,t){if(Vue.set(e,"menuActive",!1),"O"==e.licensetype)for(var a in Vue.set(e,"MOTOREF","NO"),Vue.set(e,"STARTER","NO"),Vue.set(e,"SECRETARY","NO"),e.categories)e.categories[a].MOTOREF&&Vue.set(e,"MOTOREF",e.categories[a].MOTOREF),e.categories[a].STARTER&&Vue.set(e,"STARTER",e.categories[a].MOTOREF),e.categories[a].SECRETARY&&Vue.set(e,"SECRETARY",e.categories[a].MOTOREF);var n=Date.parse(e.date_exp);if(0==isNaN(n)){var s=new Date(e.date_exp);moment().diff(s.toISOString(),"years")<4&&(Date.now()<=new Date(e.date_exp)&&""==e.license_status&&(_data.licenses.push(e),_data.activeLicenseCount+=1),"P"==e.license_status&&(_data.licenses.push(e),_data.activeLicenseCount+=1),"S"==e.license_status&&_data.licenses.push(e),Date.now()>new Date(e.date_exp)&&""==e.license_status&&(_data.expiredLicenseCount+=1,_data.licenses.push(e)))}}),usacProapi.get("/licensescomp/?comp_id="+_data.userProfile.comp_id).then(function(e){e.data.forEach(function(e,t){if(Vue.set(e,"menuActive",!1),"O"==e.licensetype)for(var a in Vue.set(e,"MOTOREF","NO"),Vue.set(e,"STARTER","NO"),Vue.set(e,"SECRETARY","NO"),e.categories)e.categories[a].MOTOREF&&Vue.set(e,"MOTOREF",e.categories[a].MOTOREF),e.categories[a].STARTER&&Vue.set(e,"STARTER",e.categories[a].MOTOREF),e.categories[a].SECRETARY&&Vue.set(e,"SECRETARY",e.categories[a].MOTOREF)}),_data.licensesComp=e.data,ACCTprofile.loadRacer()}).catch(function(e){})}).catch(function(e){}),_data.showLoader=!1},formatPhone:function(e){if(!e)return"";var t=e.match(/(\d{3})(\d{3})(\d{4})/);return t="("+t[1]+") "+t[2]+"-"+t[3]},loadProfile:function(){void 0!==_data.userProfile&&0!=_data.userProfile.length||usacProapi.get("/profile/").then(function(e){_data.userProfile=e.data,"Y"==_data.userProfile.is_admin&&(_data.revealAdmin=!0),401!=_data.userProfile.code&&_data.userProfile.comp_id||(location.href="/API/logout"),ACCTprofile.waiverCheck()}).catch(function(e){})},catFullName:function(e){if(!e)return"";switch(e=e.toString()){case"rd":return"Road";case"tr":return"Track";case"ot":return"Observed Trials";case"mx":return"Mountain Cross";case"mt":return"Mountain";case"ncca":return"Collegiate";case"xc":return"Cross Country";case"cx":return"Cyclocross";case"dh":return"Downhill"}},getRenewLink:function(e){switch(renewLinksApi.get("renew-links.json").then(function(e){_data.linksRenew=e.data,_data.raceRenew=e.data.data[0].race,_data.rideRenew=e.data.data[0].ride,_data.officialRenew=e.data.data[0].official,_data.coachRenew=e.data.data[0].coach,_data.mechanicRenew=e.data.data[0].mechanic,_data.directorRenew=e.data.data[0].director,_data.driverRenew=e.data.data[0].driver}),e){case"X":return _data.rideRenew;case"O":return _data.officialRenew;case"C":return _data.coachRenew;case"M":return _data.mechanicRenew;case"D":return _data.directorRenew;case"V":return _data.driverRenew;default:return _data.raceRenew}},getCatUpgrade:function(e){switch(e){case"ncca":return"https://legacy.usacycling.org/myusac/index.php?pagename=upgradedowngrade&type=ncca&compid="+_data.userProfile.comp_id;case"intlracer":return"https://legacy.usacycling.org/myusac/index.php?pagename=upgradedowngrade&type=intlracer&compid="+_data.userProfile.comp_id;case"usaracer":return"https://legacy.usacycling.org/myusac/index.php?pagename=upgradedowngrade&type=usaracer&compid="+_data.userProfile.comp_id;default:return""}},loadRacer:function(){_data.showLoader=!0,this.getContentBySlug("account-racer"),usacProapi.get("/user-results/").then(function(e){e.data.length>0&&(_data.results=e.data,_data.showLoader=!1)}).catch(function(e){}),usacProapi.get("/ranking/?comp_id="+_data.userProfile.comp_id).then(function(e){e.data[0]&&(_data.rankings=e.data[0])}).catch(function(e){}),_data.showLoader=!1},loadMembership:function(){_data.showLoader=!0;var e=_data.userProfile.memberships[0].membership.toLowerCase().replace(/ /g,"-").replace("($","-").replace(")","");this.getContentBySlug("account-membership-"+e),_data.showLoader=!1},loadEventDirector:function(){this.getContentBySlug("account-director")},loadClubAdmin:function(){this.getContentBySlug("account-club-admin")},loadOfficial:function(){this.getContentBySlug("account-official")},loadPreCoach:function(){this.getContentBySlug("account-pre-coach")},loadCoach:function(){this.getContentBySlug("account-coach")},loadTechnicalSupport:function(){this.getContentBySlug("account-technical-support")},getStatus:function(e){return Date.now()<=new Date(e.date_exp)&&""==e.license_status?"active":Date.now()>new Date(e.date_exp)&&""==e.license_status?"expired":"P"==e.license_status?"pending":""},renewStatus:function(e){var t=moment().format("YYYY-MM-DD"),a=moment(e.date_exp).format("YYYY-MM-DD");return t>=moment(a).subtract(31,"days").format("YYYY-MM-DD")&&""==e.license_status?"renew":""},outputStatus:function(e){return Date.now()<=new Date(e.date_exp)&&""==e.license_status?"Active":Date.now()>new Date(e.date_exp)&&""==e.license_status?"Expired":"P"==e.license_status?"Pending":""},showResults:function(e){_data.race_results=[],usacProapi.get("/race-results/?results_race_id="+e).then(function(e){e.data.length>0&&(_data.race_results=e.data,_data.currentResultName=e.data[0].event_name,_data.currentResultCity=e.data[0].race_city,_data.currentResultState=e.data[0].race_state,_data.currentResultDate=e.data[0].race_date,_data.showRaceResults=!0,_data.showResultsRanking=!1,$("html,body").animate({scrollTop:$(".race-results-tab").offset().top},"slow"))}).catch(function(e){})},checkNavOption:function(e){var t=!1;return 0==e.length||(_data.licenses.forEach(function(a,n){a.licensetype.includes(e)&&(t=!0),"RX"==e&&""==a.licensetype&&(t=!0)}),"ADMIN"==e&&(t="Y"==_data.userProfile.is_admin),"CLUBADMIN"==e&&(t="Y"==_data.userProfile.club_admin),"PRECOACH"==e&&(t="Y"==_data.userProfile.pre_coach),t)},friendlyDate:function(e){if(!e)return"";e=e.toString();return new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},rankPerc:function(e,t){return"("+(e/t*100).toFixed(2)+"%)"},returnToResults:function(){_data.showRaceResults=!1,_data.showResultsRanking=!0},printDiv:function(e,t,a){$(e).html()},getContentBySlug:function(e){_data.racerDynText="",axios.get("/inc/account/ajax/content?c="+e).then(function(e){return _data.racerDynText=e.data,e.data}).catch(function(e){return""})},scrollToTop:function(){document.body.scrollTop=document.documentElement.scrollTop=0},waiverCheck:function(){usacProapi.get("/waiver/?xfg=293381").then(function(e){""==e.data||"Invalid username/password."==e.data.detail?ACCTprofile.loadLicenses():location.href="/waivers"}).catch(function(e){})},convertYN:function(e){return"Y"==e?"YES":"N"==e?"NO":e},getAge:function(e){var t=new Date(e).getFullYear()-1+"-12-31";return moment().diff(t,"years")},getGender:function(e){return"M"==e?"Male":"F"==e?"Female":"N/A"},getExpiry:function(e){return null!=e.memberships&&null!=e.memberships&&e.memberships.length>0?e.memberships[0].expiry:"N/A"},pendFilter:function(e){_data.pendSelect==e?_data.pendSelect="":_data.pendSelect=e}}}));